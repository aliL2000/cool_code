<!DOCTYPE html>
<html>
  <head>
    <style></style>
  </head>
  <body>
    <div id="selection-screen">
      <form id="selectionForm">
        <h2>Select Your Preferences:</h2>
        <label>
          <input type="checkbox" name="option1" value="laundry" /> Laundry
          Appliances
        </label>
        <label>
          <input type="checkbox" name="option2" value="heatingAndCooling" />
          Heating and Cooling
        </label>
        <label>
          <input type="checkbox" name="option2" value="kitchenAppliance" />
          Kitchen Appliances
        </label>
        <br />
        <input type="submit" value="Submit" />
      </form>
    </div>
  </body>
  <script>
    //DETERMINE WHICH OPTIONS THE USER SELECTED
    function determineSelection() {
      //Get all the checkboxes
      const checkboxes = document.querySelectorAll(
        'input[type="checkbox"][name^="option"]'
      );
      const selectedOptions = [];
      checkboxes.forEach(function (checkbox) {
        if (checkbox.checked) {
          selectedOptions.push(checkbox.value);
        }
      });
      return selectedOptions;
    }

    //ITERATE THROUGH ALL THE OPTIONS SELECTED
    function iterateSelection(options) {
      let prices = {};
      options.forEach((option) => {
        prices[option] = determineCalculator(option);
      });
      return prices;
    }

    //START GOING THROUGH AND DETERMINING WHICH CALCULATORS TO CALL
    function determineCalculator(option) {
      removeID("selectionForm");
      switch (option) {
        case "laundry":
          let laundryOptions = renderLaundry();
          console.log(laundryOptions);
          //return calculateLaundryOptions(laundryOptions);
          return [10,20];
          break;
        case "heatingAndCooling":
          return [30, 40];
          break;
        case "kitchenAppliance":
          return [50, 60];
          break;
      }
    }

    //REFRESH THE WINDOW FOR EACH CALCULATOR
    function removeID(_id) {
      let object = document.getElementById(_id);
      if (object !== null) object.remove();
    }
    //EACH CALCULATOR MUST RENDER AND CALCULATE AND DISPLAY THE OPTIONS TO THE USER
    function renderLaundry() {
      const washingMachineOptions = ["Washer 1", "Washer 2", "Washer 3"];
      const dryerOptions = ["Dryer 1", "Dryer 2", "Dryer 3"];
      const form = document.createElement("form");
      form.id = "laundry";
      let laundryChoices = [];

      createRadioButtons(form, washingMachineOptions, "washingMachine");
      createRadioButtons(form, dryerOptions, "dryer");

      // Create a submit button
      const submitButton = document.createElement("input");
      submitButton.type = "submit";
      submitButton.value = "Submit";
      form.appendChild(submitButton);
      // Add an event listener to the form to handle submission
      form.addEventListener("submit", function (event) {
        event.preventDefault();
        const selectedWashingMachineOption = document.querySelector('input[name="washingMachine"]:checked');
        const selectedDryerOption = document.querySelector('input[name="dryer"]:checked' );
        if (selectedWashingMachineOption) {
          laundryChoices.push('${selectedWashingMachineOption.value}');
        }
        if (selectedDryerOption) {
          laundryChoices.push(` ${selectedDryerOption.value}`);
        }
      });
      const formContainer = document.getElementById("selection-screen");
      formContainer.appendChild(form);
      return laundryChoices;
    }
    //This function will render and
    function calculateLaundryOptions(laundryOptions) {
      return;
    }

    //RENDER THE PRICES ONTO HTML AND SPLIT
    function renderPrices(data) {
      // Create a table element
      const table = document.createElement("table");
      table.border = "1";

      // Create table headers
      const headerRow = document.createElement("tr");
      const headers = Object.keys(data);
      headers.forEach((headerText) => {
        const headerCell = document.createElement("th");
        headerCell.textContent = headerText;
        headerRow.appendChild(headerCell);
      });
      table.appendChild(headerRow);

      // Create table rows with data
      const values = Object.values(data);
      const numRows = Math.max(...values.map((arr) => arr.length));
      let subTotals = {}; // Store sub-totals for each column
      for (let i = 0; i < numRows; i++) {
        const row = document.createElement("tr");
        headers.forEach((headerText) => {
          const cell = document.createElement("td");
          const cellValue = data[headerText][i];
          cell.textContent = cellValue || ""; // Handle missing data
          row.appendChild(cell);

          // Calculate sub-totals
          if (!subTotals[headerText]) {
            subTotals[headerText] = 0;
          }
          subTotals[headerText] += cellValue || 0;
        });
        table.appendChild(row);
      }

      // Create a row for sub-totals
      const subTotalRow = document.createElement("tr");
      headers.forEach((headerText) => {
        const cell = document.createElement("td");
        cell.textContent = subTotals[headerText] || ""; // Handle missing sub-totals
        subTotalRow.appendChild(cell);
      });
      table.appendChild(subTotalRow);

      // Create a row for the overall total
      const overallTotalRow = document.createElement("tr");
      const overallTotal = headers.reduce(
        (total, headerText) => total + (subTotals[headerText] || 0),
        0
      );
      const overallTotalCell = document.createElement("td");
      overallTotalCell.textContent = overallTotal;
      overallTotalRow.appendChild(overallTotalCell);
      table.appendChild(overallTotalRow);

      // Append the table to the document
      document.body.appendChild(table);
    }

    //FLOW OF THE SITE
    const selectionForm = document.getElementById("selectionForm");
    selectionForm.addEventListener("submit", function (event) {
      // Prevent the form from actually submitting to a server
      event.preventDefault();

      let chosenOptions = determineSelection();
      let prices = iterateSelection(chosenOptions);
      console.log(prices);
      //renderPrices(prices);

      //Createa function that accepts the prices and mails us the info we need.
    });

    function createRadioButtons(form, options, name) {
      options.forEach((optionText, index) => {
        // Create a radio button
        const radio = document.createElement("input");
        radio.type = "radio";
        radio.name = name;
        radio.value = optionText;
        radio.id = `${name}${index + 1}`; // Unique ID for each radio button

        // Create a label for the radio button
        const label = document.createElement("label");
        label.textContent = optionText;
        label.htmlFor = `${name}${index + 1}`;

        // Append the radio button and label to the form
        form.appendChild(radio);
        form.appendChild(label);

        // Add a line break for better spacing
        form.appendChild(document.createElement("br"));
      });
    }
  </script>
</html>
